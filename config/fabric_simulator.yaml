# Gravity of environment for fabric simulation
gravity_x: 0.0 # m/s^2
gravity_y: 0.0 # m/s^2
gravity_z: -9.81 # m/s^2

dt: 0.003 # seconds. Simulated time per iteration of the fabric simulatiob.
set_sim_rate_auto: false  # to set the simulation rate and dt automaticall, do not use
num_substeps: 12 # Number of substeps per iteration based on 2019 Small Steps XPBD paper.
num_steps: 1 # experimental only. do not change from 1

fabric_mesh_path: "" # .obj file, If empty, a rectangular fabric will be generated from the fabric sizes below
# fabric_mesh_path: $(find fabric_simulator)/data/mesh/VINYL_716262.obj
# fabric_mesh_path: $(find fabric_simulator)/data/mesh/VINYL_717405.obj
# fabric_mesh_path: $(find fabric_simulator)/data/mesh/MESH_717167.obj
# fabric_mesh_path: $(find fabric_simulator)/data/mesh/MESH_717651.obj

# If fabric_mesh_path is not empty string (i.e., "") the following parameters are not used.
fabric_x: 1.5 # 1.5 # fabric x size in meters
fabric_y: 1.0 # 1.0 # fabric y size in meters
fabric_resolution: 15 # particle resolution per meter 

fabric_density: 1.0 # fabric mass per meter square (kg/m^2)

fabric_stretching_compliance: 0.0001 # 1.0e-4 # 1.0e-4 # 1.0e-9 # 0.0
fabric_bending_compliance: 0.01 #1.0e-2 # 2.0e-1 # 1.0e-7 # Note, fabric stretching compliance assumed to be 0.0 already.

set_fabric_stretching_compliance_service_name: "set_fabric_stretching_compliance" 
set_fabric_bending_compliance_service_name: "set_fabric_bending_compliance" 
get_fabric_stretching_compliance_service_name: "get_fabric_stretching_compliance" 
get_fabric_bending_compliance_service_name: "get_fabric_bending_compliance" 
change_fabric_stretching_compliance_topic_name: "change_fabric_stretching_compliance" 
change_fabric_bending_compliance_topic_name: "change_fabric_bending_compliance" 

enable_collision_handling_service_name: "enable_collision_handling" 

is_collision_handling_enabled: true # To disable the collision handling feature, default: true
contact_tolerance: 0.1 # m, It's like offset around the obstacle object for aabb checking. default: 0.1
contact_sdf_domain_offset: 2.0 # m, defines the minimum distance to a rigid body that will start contact checking and reporting minimum distance readings

# Global artificial velocity damping coefficients. Defaults to 0.0. 
global_damp_coeff_v: 7.1e-1 # 2.1e-4; // 0.9e-3

# Fabric Initial Transformations
# initial_height: 0.0 # initial fabric height from ground (m) (Deprecated, use fabric_translation instead)
fabric_translation: [1.9, 2.86, 1.0] # DEFAULT: [0, 0, 1.7] 
fabric_rotationAxis: [0, 0, 1] # DEFAULT: [0, 1, 0] 
fabric_rotationAngle: -1.570796327 # DEFAULT: 0.0 # 1.4 # Radians 
fabric_scale: [1, 1, 1] # DEFAULT: [1, 1, 1] 


# If fabric_mesh_path is not empty string (i.e., "") num_hang_corners is NOT used.
# Also, for some rotations specified this may NOT work.
num_hang_corners: 4 # num of corners to hang fabric from (options: 0,1,2,3,4)

custom_static_particles: [] # specify the particle ids to set as static
# Note: we also create an odom subscriber for each custom static particle to update their poses online.

## Fabric Corners for 2.0x2.0-15 resolution mesh 
# custom_static_particles: [0,30,930,960] # specify the particle ids to set as static
# custom_static_particles: [0,30] # specify the particle ids to set as static
# custom_static_particles: [930,960] # specify the particle ids to set as static

##  Fabric Corners for 1.5x1.0-15 resolution mesh 
# custom_static_particles: [  0,15,352,367] # specify the particle ids to set as static
# custom_static_particles: [0,15] # specify the particle ids to set as static
# custom_static_particles: [352,367] # specify the particle ids to set as static

## Fabric Corners (Holding Points) for VINYL and MESH.obj files as fabric
# custom_static_particles: [363,289,428,202] # specify the particle ids to set as static
# custom_static_particles: [472,400,558] # specify the particle ids to set as static
# custom_static_particles: [680,345,326] # specify the particle ids to set as static
# custom_static_particles: [404,225,102,521] # specify the particle ids to set as static

max_sticking_force: [100.0, 100.0, 10.0] # N, If the force is greater than this value, the sticked particle will be detached, default: [100.0, 100.0, 100.0]
max_sticking_force_check_mode: 2 # -1: Disabled, 0:X, 1:Y, 2:Z, 3:Norm (Default: -1)

custom_static_particles_cmd_vel_topic_prefix: "custom_static_particles_cmd_vel_" 
custom_static_particles_odom_topic_prefix: "custom_static_particles_odom_"
# Note: The topics names will include the id number in the end. 
# For example, for custom_static_particles_odom_topic_prefix: "custom_static_particles_odom_"
# and custom_static_particles: [0,27], we will have two odom subscriber topics named:
# "custom_static_particles_odom_0" and "custom_static_particles_odom_27"

set_particle_dynamicity_service_name: "set_particle_dynamicity" 
change_particle_dynamicity_topic_name: "change_particle_dynamicity" 

fix_nearest_fabric_particle_topic_name: "fix_nearest_fabric_particle_request"
fix_nearest_fabric_particle_service_name: "fix_nearest_fabric_particle"

attach_external_odom_frame_topic_name: "attach_external_odom_frame_request"
attach_external_odom_frame_service_name: "attach_external_odom_frame"

simulation_rate: 333.333 #1000.0
rendering_rate: 30.0 # Hz, frequency to publish the fabric vertices, edges and triangle mesh to RVIZ visualization markers

fabric_state_topic_name: "fabric_state" # topic name to publish the fabric state with custom SegmentState Array msgs 
fabric_state_pub_rate: 50.0 # Hz, frequency to publish fabric state as a feedback to some other node  

wrench_pub_rate: 100.0 # Hz, frequency to publish the fabric forces at the attachment points 
rendering_rb_rate: 2 # Hz, frequency to publish the rigid body meshes to RVIZ visualization markers
min_dist_to_rb_pub_rate: 50.0 # Hz, frequency to publish minimum distances to the rigid bodies 

# Rigid body scene .json file, If empty, no rigid bodies exist in the simulator
# rb_scene_config_path: ""
# rb_scene_config_path: $(find fabric_simulator)/config/scenes/ClothOnMandrel.json 
# rb_scene_config_path: $(find fabric_simulator)/config/scenes/ClothOnCylinderUnitBox.json
# rb_scene_config_path: $(find fabric_simulator)/config/scenes/ClothOnCylinderVaseUnitBox.json
# rb_scene_config_path: $(find fabric_simulator)/config/scenes/ClothOnFloor.json
# rb_scene_config_path: $(find fabric_simulator)/config/scenes/ClothOnCube_5.json
# rb_scene_config_path: $(find fabric_simulator)/config/scenes/ClothOnCube_5_edit.json
# rb_scene_config_path: $(find fabric_simulator)/config/scenes/ClothOnSphere.json
# rb_scene_config_path: $(find fabric_simulator)/config/scenes/ClothOnRollers.json
# rb_scene_config_path: $(find fabric_simulator)/config/scenes/ClothOnBunny.json
# rb_scene_config_path: $(find fabric_simulator)/config/scenes/ClothOnMandrelReal.json 
rb_scene_config_path: $(find fabric_simulator)/config/scenes/ClothOnMandrelReal-no-ceiling.json 

is_dependant_simulator: false # (default: false) if true, the simulator subscribes to a topic to get the particle dynamicity change updates to synchronize with the main simulator, otherwise the simulator publishes the particle dynamicity change updates to a topic for other simulators to synchronize. The changes are transferred via a custom synchronization topic.

sync_particle_updates_topic_name: "sync_particle_updates" # topic name to publish the particle dynamicity change updates to synchronize with other simulators. Either publish or subscribe to this topic based on is_dependant_simulator flag.

# FABRIC VISUALIZATION RELATED PARAMETERS
fabric_frame_id: "map" # the reference tf frame ID that the visualization marker msgs are published in.
fabric_markers_topic_name: "fabric_markers" # topic name to publish the RVIZ visualization marker msgs
fabric_visualization_mode: 4 # 0: Points Only, 1: Wireframe Only, 2: Mesh Only, 3: Points and Wireframe, 4: All
# Note that using less data in the visualization helps to save network bandwith
point_marker_scale: 0.015
point_marker_color_rgba: [1.0, 0.5, 1.0, 0.7]
static_point_marker_color_rgba: [0.0, 1.0, 0.0, 1.0]
line_marker_scale_multiplier: 1.0 # multiplies 5 mm with this scale
line_marker_color_rgba: [0.0, 0.0, 0.0, 0.5] # Outline of the fabric mesh lines
mesh_marker_color_rgba: [0.25, 0.5, 1.0, 1.0] # [0.25, 0.5, 0.5, 1.0] # Inner region of the fabric mesh lines

face_tri_ids_topic_name: "face_tri_ids" # NOT for visualization, it's like a helper state publisher of the fabric

# RIGID BODY VISUALIZATION RELATED PARAMETERS
rb_markers_topic_name: "rigid_body_markers" # topic name to publish the RVIZ visualization marker array msgs of the rigid bodies in the scene
rb_visualization_mode: 2 # 0: Mesh Only, 1: Wireframe Only, 2: Both
# Note that using less data in the visualization helps to save network bandwith
# for the rigid bodies in the scene, we assume the same frame id as the fabric
# and we are only publishing the wireframe lines and the mesh (i.e no vertex points)
rb_line_marker_scale_multiplier: 1.0 # multiplies 5 mm with this scale
rb_line_marker_color_rgba: [0.5, 1.0, 0.5, 0.025] # [0.5, 1.0, 0.5, 0.9]
rb_mesh_marker_color_rgba: [0.5, 1.0, 0.5, 0.5] # [0.0, 0.5, 0.0, 0.5] # [0.0, 0.0, 0.0, 0.5]

# MINIMUM DISTANCE VISUALIZATION RELATED PARAMETERS
# Published topic name of the minimum distances to the rigid bodies
min_dist_to_rb_topic_name: "min_dist_to_rigid_bodies" # DISTANCES TOPIC
# topic name to publish the RVIZ visualization marker msgs
min_dist_markers_topic_name: "min_dist_markers" # DISTANCES "VISUALIZATION" TOPIC 
visualize_min_distances: true
min_dist_line_marker_scale_multiplier: 4.0 # multiplies 5 mm with this scale
min_dist_line_marker_color_rgba: [1.0, 0.0, 0.0, 1.0]

robot_attach_radius: 0.1 #0.35

# Odometry topics that publishes robot positions to the fabric simulator
odom_01_topic_name: "d1/ground_truth/fabric_mount/odom"
odom_02_topic_name: "d2/ground_truth/fabric_mount/odom"
odom_03_topic_name: "d3/ground_truth/fabric_mount/odom"
odom_04_topic_name: "d4/ground_truth/fabric_mount/odom"

# TF frame names that the fabric is assumed to be attached.
wrench_01_frame_id: "d1_tf_fabric_mount_link"
wrench_02_frame_id: "d2_tf_fabric_mount_link"
wrench_03_frame_id: "d3_tf_fabric_mount_link"
wrench_04_frame_id: "d4_tf_fabric_mount_link"

fabric_rob_z_offset_: 0.0 # z offset between the specified frame and fabric attachement

# Published topic names of the forces of    robots.
wrench_01_topic_name: "d1/fabric_wrench_stamped"
wrench_02_topic_name: "d2/fabric_wrench_stamped"
wrench_03_topic_name: "d3/fabric_wrench_stamped"
wrench_04_topic_name: "d4/fabric_wrench_stamped"

